---
name: git-commit
description: 帮助用户生成符合项目规范的 git 提交消息，分析代码变更并执行提交与推送操作。
---

# Git 提交 Skill

该技能帮助用户创建规范的 Git 提交消息，分析当前代码变更，生成符合项目规范的提交信息，并执行 Git 提交和推送操作。

## When to Use

- 当用户需要提交代码时，可以使用此技能来生成规范的提交消息并自动推送到远程仓库。
- 该技能特别适用于需要遵循严格提交规范的团队或项目。

## Instructions

1. **检查变更状态**  
   使用 `git status` 检查工作区和暂存区的状态。
   
2. **查看变更内容**  
   使用 `git diff` 查看未暂存的变更，使用 `git diff --cached` 查看已暂存的变更。

3. **生成提交消息**  
   根据变更的文件和类型，生成符合项目提交规范的中文提交消息。例如：
   - `feat: 新增用户登录功能`
   - `fix: 修复任务完成数量计算错误`
   - `docs: 更新快速开始文档`

4. **添加文件到暂存区**  
   根据需要将文件添加到暂存区。可以通过 `git add .` 添加所有变更，或者 `git add <file>` 添加指定文件。

5. **执行提交**  
   使用 `git commit -m "生成的提交消息"` 提交代码。

6. **推送到远程仓库**  
   使用 `git push` 将代码推送到远程仓库。

7. **验证提交**  
   使用 `git log -1` 查看最后一次提交，使用 `git status` 检查工作区状态。

## When to Use This Skill

- **提交新功能**：例如新增一个模块或功能。
- **修复 bug**：例如修复代码中的错误。
- **更新文档**：例如更新 README 或其他文档。
- **优化性能**：例如优化代码效率或减少资源消耗。

## 提交消息规范

### 基本格式

```

<type>: <中文简短描述>

<中文详细说明(可选)>

```

### 提交类型

- **feat**: 新功能
- **fix**: 修复 bug
- **docs**: 文档更新
- **refactor**: 代码重构
- **perf**: 性能优化
- **test**: 测试相关
- **chore**: 构建/工具配置等
- **style**: 代码格式调整
- **revert**: 回滚

### 消息风格

- 使用英文类型标识（如 `feat`、`fix`）作为提交消息的开头。
- 中文描述应简洁明了，突出变更的目的，而非实施细节。
- 详细说明部分应使用中文，描述变更的背景或进一步的解释。

## 提交消息生成规则

### 分析代码变更

1. **查看变更文件**  
   - **前端文件**（`frontend/`）：关注 UI 组件、API 调用等。
   - **后端文件**（`backend/`）：关注模型、视图、业务逻辑等。
   - **文档文件**（`docs/`）：标记为 `docs:` 类型。
   - **配置文件**：根据具体内容判断类型（如 `chore:`）。

2. **判断变更类型**
   - 新增功能 → `feat:`
   - 修复问题 → `fix:`
   - 性能优化 → `perf:`
   - 代码重构 → `refactor:`
   - 文档更新 → `docs:`
   - 格式调整 → `style:`

3. **生成提交消息**
   - 格式：`<英文类型>: <中文描述>`
   - 核心描述要简洁，突出变更目的和业务价值。
   - 详细说明应简洁描述变更原因或上下文，避免过度解释。

### 示例

**场景 1：新增功能**
```

变更: 新增用户角色管理功能
提交: feat: 新增用户角色管理功能，支持角色权限设置

```

**场景 2：修复 bug**
```

变更: 修复任务状态更新错误
提交: fix: 修复任务状态更新错误，确保状态正确显示

```

**场景 3：文档更新**
```

变更: 更新安装与配置文档
提交: docs: 更新安装文档，添加新依赖说明

```

**场景 4：性能优化**
```

变更: 优化图片加载时间
提交: perf: 优化图片加载时间，使用懒加载减少首次渲染时间

```

**场景 5：代码重构**
```

变更: 重构用户认证模块
提交: refactor: 重构用户认证模块，简化逻辑，提高可维护性

````

## 注意事项

### 提交前检查

- ✅ 确认没有提交敏感信息（如密码、密钥等）。
- ✅ 确认代码已通过必要的测试（单元测试、集成测试等）。
- ✅ 提交消息应准确描述变更内容。
- ✅ 避免提交临时代码或调试代码。
- ✅ 提交前执行 `git pull` 确保代码是最新的。

### 提交最佳实践

- ✅ 每个提交应对应一个逻辑完整的变更。
- ✅ 提交消息简洁明了，突出变更的目的。
- ✅ 避免过大的提交，尽量拆分为多个小提交。
- ✅ 提交后立即推送到远程仓库。

### 推送最佳实践

- ✅ 提交后立即执行 `git push`。
- ✅ 如果推送失败，先执行 `git pull` 解决冲突。
- ✅ 避免推送前有大量未提交的本地提交。
- ✅ 保持本地和远程仓库同步。

### 错误处理

- 如果 **pre-commit hook** 失败，尝试修复代码或重新提交。
- 如果提交失败，查看错误信息并进行调整后重试。
- 如果遇到 **合并冲突**，先解决冲突再提交。
- 如果推送失败，先执行 `git pull` 更新本地代码。

## 快捷指令示例

### 查看变更
```bash
git status
git diff
git diff --staged
````

### 查看提交历史

```bash
git log --oneline -10
git log -1 --stat
```

### 提交和推送

```bash
git add .                     # 添加所有变更
git add <file>                # 添加指定文件
git commit -m "type: 中文描述" # 提交
git push                      # 推送到远程
git commit --amend            # 修改最后一次提交
```

### 同步远程仓库

```bash
git pull                      # 拉取远程更新
git push                      # 推送本地提交
git pull --rebase             # 拉取并变基
```

## 扩展功能

### 创建 Pull Request

此技能可扩展支持以下功能：

* 自动创建 Pull Request
* 生成 PR 描述并关联相关 Issue

### 分支管理

* 创建新分支: `git checkout -b feature/xxx`
* 合并分支: `git merge branch-name`
* 推送分支: `git push -u origin branch-name`
* 删除分支: `git branch -d branch-name`

### 标签管理

* 创建标签: `git tag -a v1.0.0 -m "版本描述"`
* 推送标签: `git push --tags`

---

**最后更新**: 2026-01-10
**适用项目**: work_order（印刷施工单跟踪系统）
**技术栈**: Vue.js + Django REST Framework

---