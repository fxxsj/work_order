---
wave: 2
depends_on: 06-01
files_modified:
  - frontend/src/views/workorder/components/TaskSection.vue
  - frontend/src/mixins/crudPermissionMixin.js
autonomous: true
---

# Plan 06-02: Inline Task Editing

## Overview
在施工单页面添加草稿任务的内联编辑功能。权限控制：makers/sales staff 可编辑草稿任务，其他角色只能查看。

## Tasks

### Task 1: Add edit mode controls to TaskSection
- **Action**: Add inline editing capability for draft tasks
- **Files**: frontend/src/views/workorder/components/TaskSection.vue
- **Verify**: Draft tasks show edit button for authorized users
- **Done**:
  - Add `canEditTask` computed property based on user role
  - Add inline edit buttons for draft tasks
  - Implement edit dialog for task quantity, priority, notes
  - Connect to workOrderTaskAPI.update() method

### Task 2: Add permission check for task editing
- **Action**: Implement role-based permission checking
- **Files**: frontend/src/mixins/crudPermissionMixin.js, frontend/src/views/workorder/components/TaskSection.vue
- **Verify**: Only makers and sales staff see edit controls
- **Done**:
  - Add `canEditDraftTasks()` method to check user roles
  - Import and use permissionMixin in TaskSection.vue
  - Conditionally show edit buttons based on permission
  - Disable edit buttons for non-draft tasks

### Task 3: Implement bulk edit for multiple draft tasks
- **Action**: Add batch editing capability for selected draft tasks
- **Files**: frontend/src/views/workorder/components/TaskSection.vue
- **Verify**: Can select multiple tasks and edit them together
- **Done**:
  - Add selection checkboxes to task table
  - Add bulk edit dialog (quantity, priority, notes)
  - Connect to workOrderTaskAPI.bulkUpdate() method
  - Show success message after bulk update

## Verification Criteria
- [ ] Edit buttons appear on draft tasks for makers/sales staff
- [ ] Edit dialog allows modifying quantity, priority, notes
- [ ] Changes save successfully via API
- [ ] Other user roles cannot see edit buttons
- [ ] Bulk edit works for multiple selected tasks
- [ ] Non-draft tasks are not editable

## Must Haves
1. Edit button on draft tasks for authorized roles
2. Single task edit dialog with quantity, priority, notes
3. Bulk edit functionality for multiple draft tasks
4. Role-based permission control (makers/sales only)
